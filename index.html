<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Enhanced Before / After</title>
<style>
 body { margin:0; background:#111; display:flex; flex-direction:column; align-items:center; color:white; padding-bottom:40px; }
 #container { position:relative; width:90vw; max-width:500px; aspect-ratio:1/1; overflow:hidden; border-radius:16px; margin-top:20px; }
 img { width:100%; height:100%; object-fit:cover; pointer-events:none; }
 #after { position:absolute; top:0; left:0; width:50%; height:100%; overflow:hidden; }
 #handle { position:absolute; top:0; left:50%; width:6px; height:100%; background:white; cursor:ew-resize; border-radius:3px; }
 #upload { margin-top:10px; }
 #controls { width:90vw; max-width:500px; margin-top:10px; display:flex; flex-direction:column; gap:10px; }
 #controls label { font-size:14px; }
 #controls input[type=range] { width:100%; }
 #preset { margin-top:10px; padding:6px; border-radius:6px; }
 #reset { margin-top:10px; padding:8px 14px; border-radius:8px; background:#333; color:white; cursor:pointer; }
 #save { margin-top:10px; padding:8px 14px; border-radius:8px; background:#28a745; color:white; cursor:pointer; }
</style>
</head>
<body>

<input type="file" id="upload" accept="image/*" />

<div id="controls">
 <label>Kontrast <span id="cVal">120</span>%</label>
 <input type="range" id="contrast" min="50" max="200" value="120">

 <label>Parlaklık <span id="bVal">110</span>%</label>
 <input type="range" id="brightness" min="50" max="200" value="110">

 <label>Doygunluk <span id="sVal">130</span>%</label>
 <input type="range" id="saturate" min="50" max="300" value="130">

 <label>Hue Rotate <span id="hVal">15</span>°</label>
 <input type="range" id="hue" min="0" max="360" value="15">

 <label>Sepia <span id="sepVal">10</span>%</label>
 <input type="range" id="sepia" min="0" max="100" value="10">

 <label>Blur <span id="blurVal">0</span>px</label>
 <input type="range" id="blur" min="0" max="10" value="0">

 <label>Opacity <span id="opVal">100</span>%</label>
 <input type="range" id="opacity" min="10" max="100" value="100">

 <label>Vignette <span id="vigVal">0</span>%</label>
 <input type="range" id="vignette" min="0" max="80" value="0">

 <select id="preset">
  <option value="none">Hazır Efektler</option>
  <option value="warm">Warm</option>
  <option value="cool">Cool</option>
  <option value="hdr">HDR</option>
  <option value="cinema">Cinema</option>
  <option value="bw">Black & White</option>
 </select>

 <button id="reset">Sıfırla</button>
 <button id="save">Kaydet</button>
</div>

<div id="container">
 <img id="before" />
 <div id="after"><img id="afterImg" /></div>
 <div id="handle"></div>
</div>

<canvas id="canvas" style="display:none;"></canvas>

<script>
const upload = document.getElementById("upload");
const beforeImg = document.getElementById("before");
const afterImg = document.getElementById("afterImg");
const container = document.getElementById("container");
const afterBox = document.getElementById("after");
const handle = document.getElementById("handle");

// Slider logic
let active = false;
const move = x => {
 const rect = container.getBoundingClientRect();
 const pos = Math.min(Math.max(x - rect.left, 0), rect.width);
 afterBox.style.width = pos + "px";
 handle.style.left = pos + "px";
};
handle.addEventListener("mousedown", () => active = true);
window.addEventListener("mouseup", () => active = false);
window.addEventListener("mousemove", e => active && move(e.clientX));
handle.addEventListener("touchstart", () => active = true);
window.addEventListener("touchend", () => active = false);
window.addEventListener("touchmove", e => active && move(e.touches[0].clientX));

let loadedURL = null;
upload.addEventListener("change", e => {
 if (loadedURL) URL.revokeObjectURL(loadedURL);
 loadedURL = URL.createObjectURL(e.target.files[0]);
 beforeImg.src = loadedURL;
 afterImg.src = loadedURL;
});

// FILTER ELEMENTS
const filters = {
 contrast: document.getElementById("contrast"),
 brightness: document.getElementById("brightness"),
 saturate: document.getElementById("saturate"),
 hue: document.getElementById("hue"),
 sepia: document.getElementById("sepia"),
 blur: document.getElementById("blur"),
 opacity: document.getElementById("opacity"),
 vignette: document.getElementById("vignette")
};

const vals = {
 cVal: document.getElementById("cVal"),
 bVal: document.getElementById("bVal"),
 sVal: document.getElementById("sVal"),
 hVal: document.getElementById("hVal"),
 sepVal: document.getElementById("sepVal"),
 blurVal: document.getElementById("blurVal"),
 opVal: document.getElementById("opVal"),
 vigVal: document.getElementById("vigVal")
};

function applyFilters() {
 vals.cVal.textContent = filters.contrast.value;
 vals.bVal.textContent = filters.brightness.value;
 vals.sVal.textContent = filters.saturate.value;
 vals.hVal.textContent = filters.hue.value;
 vals.sepVal.textContent = filters.sepia.value;
 vals.blurVal.textContent = filters.blur.value;
 vals.opVal.textContent = filters.opacity.value;
 vals.vigVal.textContent = filters.vignette.value;

 afterImg.style.filter = `
   contrast(${filters.contrast.value}%)
   brightness(${filters.brightness.value}%)
   saturate(${filters.saturate.value}%)
   hue-rotate(${filters.hue.value}deg)
   sepia(${filters.sepia.value}%)
   blur(${filters.blur.value}px)
   opacity(${filters.opacity.value}%)
 `;
 afterBox.style.boxShadow = `inset 0 0 ${filters.vignette.value}px rgba(0,0,0,0.8)`;
}

Object.values(filters).forEach(el => el.addEventListener("input", applyFilters));

// PRESETS
const preset = document.getElementById("preset");
preset.addEventListener("change", () => {
 switch(preset.value){
  case "warm":
   filters.hue.value = 20;
   filters.saturate.value = 150;
   break;
  case "cool":
   filters.hue.value = 200;
   filters.brightness.value = 120;
   break;
  case "hdr":
   filters.contrast.value = 180;
   filters.brightness.value = 130;
   filters.saturate.value = 160;
   break;
  case "cinema":
   filters.sepia.value = 30;
   filters.vignette.value = 40;
   break;
  case "bw":
   filters.saturate.value = 0;
   break;
 }
 applyFilters();
});

// RESET
const resetBtn = document.getElementById("reset");
resetBtn.addEventListener("click", () => {
 Object.entries(filters).forEach(([k,v])=>{
  v.value = v.defaultValue;
 });
 preset.value = "none";
 applyFilters();
});

// SAVE
const saveBtn = document.getElementById("save");
saveBtn.addEventListener("click", () => {
 const canvas = document.getElementById("canvas");
 const ctx = canvas.getContext("2d");
 canvas.width = beforeImg.naturalWidth;
 canvas.height = beforeImg.naturalHeight;
 ctx.filter = afterImg.style.filter;
